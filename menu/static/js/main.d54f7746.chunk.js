(this["webpackJsonpmenu-dev"]=this["webpackJsonpmenu-dev"]||[]).push([[0],{137:function(e,t,n){e.exports=n(224)},142:function(e,t,n){},144:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(8),o=n.n(i),l=(n(142),n(143),n(144),n(231)),u=n(52),s=n(25),c=n(134),m=n(120),g=n(121),d=n(131),f=n(122),h=n(132),p=n(7),y=n.n(p),v=n(92),C=n(230),E=n(229),x=n(227),H=n(129),M=n(12),b=n(36),k=new b.MDiningPromiseClient("https://michigan-dining-api.tendiesti.me"),S=n(228),w=n(233),D=n(232),L=function(e){var t=e.count,n=e.onClick,a=r.a.createElement(M.a,{type:"heart",theme:"filled",style:{color:"red",fontSize:"26px",lineHeight:"26px",paddingTop:"4px"}});return r.a.createElement(w.a,{count:t,overflowCount:99999999,offset:[3.5*Math.floor(Math.log10(t))-5,5]},r.a.createElement(D.a,{size:"large",shape:"circle",type:"danger",ghost:!0,style:{padding:"0px",margin:"5px",paddingTop:"1px"},onClick:function(){return n()}},a))},N=function(e){var t=e.category,n=e.heartCounts,a=e.onHeartClick;return r.a.createElement("div",null,r.a.createElement("h2",{style:{fontSize:"12pt",margin:"2px",marginTop:"10px",fontWeight:600}},t.getName()),r.a.createElement(E.a,{style:{boxShadow:"0px 0px 4px 0px rgba(0, 0, 0, 0.1)",borderRadius:"5px"},bodyStyle:{padding:"10px"}},r.a.createElement(S.a,{itemLayout:"horizontal",dataSource:t.getMenuitemList(),size:"small",split:!1,renderItem:function(e){return r.a.createElement(S.a.Item,{style:{padding:"0px"}},r.a.createElement(S.a.Item.Meta,{style:{padding:"0px"},description:r.a.createElement("div",null,r.a.createElement("h4",{style:{padding:"0px",margin:"0px"}},e.getName()),r.a.createElement("p",{style:{margin:"0px",padding:"0px",display:"block"}},r.a.createElement("i",null,e.getAttributeList().reduce((function(e,t){return"".concat(e," ").concat(t)}),"")," - "),r.a.createElement("i",null,e.getAllergensList().reduce((function(e,t){return"".concat(e," ").concat(t)}),""))))}),r.a.createElement(L,{food:e.getName().toLowerCase(),count:n[e.getName().toLowerCase()],onClick:function(){return a(e.getName().toLowerCase())}}))}})))},O=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={diningHalls:[],menus:[],selectedCampus:"DINING HALLS",selectedDiningHall:0,selectedDate:y()(),selectedMenu:0,loading:!0,heartCounts:{}},n.menuCache={},n.heartStream=null,n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;k.getDiningHalls(new b.DiningHallsRequest).then((function(t){var n=t.getDininghallsList(),a=n.findIndex((function(e){return"Bursley Dining Hall"===e.getName()}));e.setState({diningHalls:n,selectedDiningHall:a},(function(){return e.fetchMenu()}))})).catch((function(e){return console.log(e)}))}},{key:"getHoursOfMenu",value:function(e){var t=this.state,n=t.selectedDiningHall,a=t.selectedDate,r=t.diningHalls,i=0===r.length?null:r[n].getDayeventsList().find((function(e){return y()(e.getKey()).day()===a.day()})),o=i?i.getCalendareventList().find((function(t){return t.getEventtitle().toLowerCase()===e.getMeal().toLowerCase()})):null;return o||null}},{key:"getStartTimeOfMenu",value:function(e){var t=this.getHoursOfMenu(e);return t?y()(t.getEventtimestart()):null}},{key:"getEndTimeOfMenu",value:function(e){var t=this.getHoursOfMenu(e);return t?y()(t.getEventtimeend()):null}},{key:"firstMenuWithCategories",value:function(e){var t=this,n=this.state.selectedDate,a=y()();if(n.isSame(a,"day")){var r=e.map((function(e,t){return{idx:t,menu:e}})).filter((function(e){return e.menu.getHascategories()&&t.getEndTimeOfMenu(e.menu)&&t.getEndTimeOfMenu(e.menu).isSameOrAfter(a)}));return 0===r.length?0:r.sort((function(e,n){var r=t.getHoursOfMenu(e.menu),i=t.getHoursOfMenu(n.menu);return a.isAfter(y()(r.getEventtimestart()))?-1:a.isAfter(y()(i.getEventtimestart()))?1:y()(r.getEventtimestart()).diff(a)-y()(i.getEventtimestart()).diff(a)}))[0].idx}var i=e.findIndex((function(e){return e.getHascategories()}));return-1===i?0:i}},{key:"fetchMenu",value:function(){var e=this,t=this.state,n=t.diningHalls,a=t.selectedCampus,r=t.selectedDiningHall,i=t.selectedDate;if(0!==n.length){var o=a+r+i.format("YYYY-MM-DD");if(this.menuCache.hasOwnProperty(o)){var l=this.menuCache[o];this.setMenus(l)}else{var u=new b.MenuRequest;u.setDate(i.format("YYYY-MM-DD")),u.setDininghall(n[r].getName()),u.setMeal(null),this.setState({loading:!0}),k.getMenu(u).then((function(t){var n=t.getMenusList();e.menuCache[o]=n,e.setMenus(n)})).catch((function(e){return console.log(e)}))}}}},{key:"fetchHeartCountsForMenus",value:function(e){var t=this,n=new b.HeartsRequest,a=e.map((function(e){return e.getCategoryList()})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.getMenuitemList()})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.getName().toLowerCase()}));new Set(a).forEach((function(e){return n.addKeys(e)})),console.log(n),k.getHearts(n).then((function(e){return t.updateHeartCounts(e)})).catch((function(e){return console.log(e)}))}},{key:"setMenus",value:function(e){this.fetchHeartCountsForMenus(e),this.stopListeningHearts(),this.startListeningHeartsForMenus(e),this.setState({menus:e,selectedMenu:this.firstMenuWithCategories(e),loading:!1})}},{key:"onChangeDate",value:function(e){var t=this;this.setState({selectedDate:e},(function(){return t.fetchMenu()}))}},{key:"onChangeDiningHall",value:function(e){var t=this;this.setState({selectedDiningHall:e},(function(){return t.fetchMenu()}))}},{key:"onChangeCampus",value:function(e){var t=this,n=this.state.diningHalls.findIndex((function(t){return t.getCampus()===e}));this.setState({selectedCampus:e,selectedDiningHall:n},(function(){return t.fetchMenu()}))}},{key:"onHeartClick",value:function(e){var t=this,n=new b.HeartsRequest;n.addKeys(e),k.addHeart(n).then((function(e){return t.updateHeartCounts(e)})).catch((function(e){return console.log(e)}))}},{key:"updateHeartCounts",value:function(e){var t=this.state.heartCounts,n=Object(c.a)({},t);e.getCountsList().forEach((function(e){return n[e.getKey()]=e.getCount()})),this.setState({heartCounts:n})}},{key:"startListeningHeartsForMenus",value:function(e){var t=this,n=new b.HeartsRequest,a=e.map((function(e){return e.getCategoryList()})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.getMenuitemList()})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.getName().toLowerCase()}));new Set(a).forEach((function(e){return n.addKeys(e)})),this.heartStream=k.streamHearts(n),this.heartStream.on("data",(function(e){return t.updateHeartCounts(e)})),this.heartStream.on("status",(function(e){return console.log(e)})),this.heartStream.on("error",(function(e){return console.log(e)})),this.heartStream.on("end",(function(){return console.log("End of stream")}))}},{key:"stopListeningHearts",value:function(){null!==this.heartStream&&this.heartStream.cancel(),this.heartStream=null}},{key:"componentWillUnmount",value:function(){this.stopListeningHearts()}},{key:"renderCategories",value:function(){var e=this,t=this.state,n=t.selectedMenu,a=t.menus,i=t.heartCounts;if(0===a.length)return r.a.createElement("b",null,"There's no data for this date :(");var o=a[n];return o.getHascategories()?o.getCategoryList().map((function(t){return r.a.createElement(N,{key:t.getName(),category:t,heartCounts:i,onHeartClick:function(t){return e.onHeartClick(t)}})})):r.a.createElement("b",null,o.getDescription())}},{key:"render",value:function(){var e=this,t=this.props.style,n=this.state,a=n.selectedCampus,i=n.selectedDiningHall,o=n.selectedDate,l=n.selectedMenu,c=n.diningHalls,m=n.menus,g=n.loading,d=Array.from(new Set(c.map((function(e){return e.getCampus()})))).sort((function(e,t){return e.localeCompare(t)})).map((function(e){return r.a.createElement(C.a.Button,{key:e,value:e},e)})),f=c.map((function(e,t){return{idx:t,diningHall:e}})).sort((function(e,t){return e.diningHall.getName().localeCompare(t.diningHall.getName())})).filter((function(e){return e.diningHall.getCampus()===a})).map((function(e){return r.a.createElement(C.a.Button,{style:{minWidth:205},key:e.idx,value:e.idx},e.diningHall.getName())})),h=0===c.length||0===m.length?null:this.getHoursOfMenu(m[l]),p=h?y()(h.getEventtimestart()):y()(),b=h?y()(h.getEventtimeend()):y()(),k=null,S=p.format("h:mma"),w=b.format("h:mma");y()().isBetween(p.clone().subtract(24,"hours"),b.clone().add(24,"hours"))&&(k=y()().isBefore(p)?"Opens "+p.fromNow():y()().isBefore(b)?"Closes "+b.fromNow():"Closed "+b.fromNow()+" :(");var D=m.map((function(t,n){return{idx:n,meal:t.getMeal(),startTime:e.getStartTimeOfMenu(t)}})).sort((function(e,t){return e.startTime&&t.startTime?e.startTime.isBefore(t.startTime)?-1:e.meal.localeCompare(t.meal):e.startTime?-1:t.startTime?1:e.meal.localeCompare(t.meal)})).map((function(e){return r.a.createElement(C.a.Button,{style:{minWidth:125},key:e.idx,value:e.idx},e.meal)}));return r.a.createElement("div",{className:"Menu",style:t},r.a.createElement(u.a,{type:"flex",justify:"center"},r.a.createElement(s.a,{span:23},r.a.createElement(E.a,{style:{boxShadow:"0px 0px 4px 0px rgba(0, 0, 0, 0.1)",borderRadius:"5px",padding:"0px"},bodyStyle:{padding:"10px"}},r.a.createElement(C.a.Group,{style:{maxWidth:800,margin:"5px"},value:a,buttonStyle:"solid",onChange:function(t){return e.onChangeCampus(t.target.value)}},d),r.a.createElement(v.MobileView,null,r.a.createElement("input",{style:{margin:"5px",fontSize:"16px"},type:"date",value:o.format("YYYY-MM-DD"),onChange:function(t){return e.onChangeDate(y()(t.target.value))}})),r.a.createElement(v.BrowserView,{style:{display:"inline-block"}},r.a.createElement(x.a,{style:{margin:"5px"},value:o,onChange:function(t){return e.onChangeDate(t)},allowClear:!1})),r.a.createElement(C.a.Group,{style:{maxWidth:800,margin:"5px"},value:i,buttonStyle:"solid",onChange:function(t){return e.onChangeDiningHall(t.target.value)}},f),r.a.createElement("br",null),r.a.createElement(C.a.Group,{style:{maxWidth:400,margin:"5px"},value:l,buttonStyle:"solid",onChange:function(t){return e.setState({selectedMenu:t.target.value})}},D)))),r.a.createElement("br",null),r.a.createElement(H.a,{indicator:r.a.createElement(M.a,{type:"loading",style:{fontSize:24},spin:!0}),spinning:g},r.a.createElement(u.a,{type:"flex",justify:"center"},r.a.createElement(s.a,{span:23},r.a.createElement(E.a,{style:{boxShadow:"0px 0px 4px 0px rgba(0, 0, 0, 0.1)",borderRadius:"5px",padding:"0px"},bodyStyle:{padding:"10px"}},h?r.a.createElement("p",null,k,r.a.createElement("br",null),r.a.createElement("i",null,"Hours: ",S," - ",w)):null,this.renderCategories())))))}}]),t}(a.Component),T=l.a.Header,W=l.a.Footer,B=l.a.Content,Y={color:"#000000",textDecoration:"none"};var j=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(l.a,{style:{backgroundColor:"transparent"}},r.a.createElement(T,{style:{backgroundColor:"transparent",fontSize:"18pt",fontWeight:600}},"MDining Menus"),r.a.createElement(B,{style:{backgroundColor:"transparent"}},r.a.createElement(u.a,{type:"flex",justify:"center"},r.a.createElement(s.a,null,r.a.createElement(O,{style:{maxWidth:"700px"}})))),r.a.createElement(W,{style:{backgroundColor:"transparent"}},r.a.createElement("a",{href:"/"},"tendies time"),r.a.createElement("br",null),r.a.createElement("a",{href:"/stats"},"mdining statistics"),r.a.createElement("br",null),"\xa9 2019-2020 ",r.a.createElement("a",{href:"https://andersboberg.com",target:"_blank",rel:"noopener noreferrer",style:Y},"Anders Boberg"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[137,1,2]]]);
//# sourceMappingURL=main.d54f7746.chunk.js.map